{"version":3,"file":"footer-popover.min.js","sources":["../src/footer-popover.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\r\n//\r\n// Moodle is free software: you can redistribute it and/or modify\r\n// it under the terms of the GNU General Public License as published by\r\n// the Free Software Foundation, either version 3 of the License, or\r\n// (at your option) any later version.\r\n//\r\n// Moodle is distributed in the hope that it will be useful,\r\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n// GNU General Public License for more details.\r\n//\r\n// You should have received a copy of the GNU General Public License\r\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\r\n\r\n/**\r\n * Shows the footer content in a popover.\r\n *\r\n * @module     theme_boost/footer-popover\r\n * @copyright  2021 Bas Brands\r\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\r\n */\r\n\r\nimport $ from \"jquery\";\r\nimport Popover from \"./popover\";\r\n\r\nconst SELECTORS = {\r\n  FOOTERCONTAINER: '[data-region=\"footer-container-popover\"]',\r\n  FOOTERCONTENT: '[data-region=\"footer-content-popover\"]',\r\n  FOOTERBUTTON: '[data-action=\"footer-popover\"]',\r\n};\r\n\r\nlet footerIsShown = false;\r\n\r\nexport const init = () => {\r\n  const container = document.querySelector(SELECTORS.FOOTERCONTAINER);\r\n  const footerButton = document.querySelector(SELECTORS.FOOTERBUTTON);\r\n\r\n  // All jQuery in this code can be replaced when MDL-71979 is integrated.\r\n  $(footerButton).popover({\r\n    content: getFooterContent,\r\n    container: container,\r\n    html: true,\r\n    placement: \"top\",\r\n    customClass: \"footer\",\r\n    trigger: \"click\",\r\n  });\r\n\r\n  document.addEventListener(\r\n    \"click\",\r\n    (e) => {\r\n      if (footerIsShown && !e.target.closest(SELECTORS.FOOTERCONTAINER)) {\r\n        $(footerButton).popover(\"hide\");\r\n      }\r\n    },\r\n    true\r\n  );\r\n\r\n  document.addEventListener(\"keydown\", (e) => {\r\n    if (footerIsShown && e.key === \"Escape\") {\r\n      $(footerButton).popover(\"hide\");\r\n      footerButton.focus();\r\n    }\r\n  });\r\n\r\n  document.addEventListener(\r\n    \"focus\",\r\n    (e) => {\r\n      if (footerIsShown && !e.target.closest(SELECTORS.FOOTERCONTAINER)) {\r\n        $(footerButton).popover(\"hide\");\r\n      }\r\n    },\r\n    true\r\n  );\r\n\r\n  $(footerButton).on(\"show.bs.popover\", () => {\r\n    footerIsShown = true;\r\n  });\r\n\r\n  $(footerButton).on(\"hide.bs.popover\", () => {\r\n    footerIsShown = false;\r\n  });\r\n};\r\n\r\n/**\r\n * Get the footer content for popover.\r\n *\r\n * @returns {String} HTML string\r\n * @private\r\n */\r\nconst getFooterContent = () => {\r\n  return document.querySelector(SELECTORS.FOOTERCONTENT).innerHTML;\r\n};\r\n\r\nexport { Popover };\r\n"],"names":["SELECTORS","footerIsShown","container","document","querySelector","footerButton","popover","content","getFooterContent","html","placement","customClass","trigger","addEventListener","e","target","closest","key","focus","on","innerHTML"],"mappings":";;;;;;;4QA0BMA,0BACa,2CADbA,wBAEW,yCAFXA,uBAGU,qCAGZC,eAAgB,gBAEA,WACZC,UAAYC,SAASC,cAAcJ,2BACnCK,aAAeF,SAASC,cAAcJ,4CAG1CK,cAAcC,QAAQ,CACtBC,QAASC,iBACTN,UAAWA,UACXO,MAAM,EACNC,UAAW,MACXC,YAAa,SACbC,QAAS,UAGXT,SAASU,iBACP,SACCC,IACKb,gBAAkBa,EAAEC,OAAOC,QAAQhB,gDACnCK,cAAcC,QAAQ,WAG5B,GAGFH,SAASU,iBAAiB,WAAYC,IAChCb,eAA2B,WAAVa,EAAEG,0BACnBZ,cAAcC,QAAQ,QACxBD,aAAaa,YAIjBf,SAASU,iBACP,SACCC,IACKb,gBAAkBa,EAAEC,OAAOC,QAAQhB,gDACnCK,cAAcC,QAAQ,WAG5B,uBAGAD,cAAcc,GAAG,mBAAmB,KACpClB,eAAgB,yBAGhBI,cAAcc,GAAG,mBAAmB,KACpClB,eAAgB,YAUdO,iBAAmB,IAChBL,SAASC,cAAcJ,yBAAyBoB"}