{"version":3,"file":"loader.min.js","sources":["../src/loader.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Template renderer for Moodle. Load and render Moodle templates with Mustache.\n *\n * @module     theme_boost/loader\n * @copyright  2015 Damyon Wiese <damyon@moodle.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n * @since      2.9\n */\n\nimport $ from \"jquery\";\nimport * as Aria from \"./aria\";\nimport Bootstrap from \"./index\";\nimport Pending from \"core/pending\";\nimport { DefaultWhitelist } from \"./bootstrap/tools/sanitizer\";\nimport setupBootstrapPendingChecks from \"./pending\";\n\n/**\n * Rember the last visited tabs.\n */\nconst rememberTabs = () => {\n  $('a[data-toggle=\"tab\"]').on(\"shown.bs.tab\", function (e) {\n    var hash = $(e.target).attr(\"href\");\n    if (history.replaceState) {\n      history.replaceState(null, null, hash);\n    } else {\n      location.hash = hash;\n    }\n  });\n  const hash = window.location.hash;\n  if (hash) {\n    const tab = document.querySelector('[role=\"tablist\"] [href=\"' + hash + '\"]');\n    if (tab) {\n      tab.click();\n    }\n  }\n};\n\n/**\n * Enable all popovers\n *\n */\nconst enablePopovers = () => {\n  $(\"body\").popover({\n    container: \"body\",\n    selector: '[data-toggle=\"popover\"]',\n    trigger: \"focus\",\n    whitelist: Object.assign(DefaultWhitelist, {\n      table: [],\n      thead: [],\n      tbody: [],\n      tr: [],\n      th: [],\n      td: [],\n    }),\n  });\n\n  document.addEventListener(\"keydown\", (e) => {\n    if (e.key === \"Escape\" && e.target.closest('[data-toggle=\"popover\"]')) {\n      $(e.target).popover(\"hide\");\n    }\n  });\n};\n\n/**\n * Enable tooltips\n *\n */\nconst enableTooltips = () => {\n  $(\"body\").tooltip({\n    container: \"body\",\n    selector: '[data-toggle=\"tooltip\"]',\n  });\n};\n\nconst pendingPromise = new Pending(\"theme_boost/loader:init\");\n\n// Add pending promise event listeners to relevant Bootstrap custom events.\nsetupBootstrapPendingChecks();\n\n// Setup Aria helpers for Bootstrap features.\nAria.init();\n\n// Remember the last visited tabs.\nrememberTabs();\n\n// Enable all popovers.\nenablePopovers();\n\n// Enable all tooltips.\nenableTooltips();\n\n// Disables flipping the dropdowns up or dynamically repositioning them along the Y-axis (based on the viewport)\n// to prevent the dropdowns getting hidden behind the navbar or them covering the trigger element.\n$.fn.dropdown.Constructor.Default.popperConfig = {\n  modifiers: {\n    flip: {\n      enabled: false,\n    },\n    storeTopPosition: {\n      enabled: true,\n      // eslint-disable-next-line no-unused-vars\n      fn(data, options) {\n        data.storedTop = data.offsets.popper.top;\n        return data;\n      },\n      order: 299,\n    },\n    restoreTopPosition: {\n      enabled: true,\n      // eslint-disable-next-line no-unused-vars\n      fn(data, options) {\n        data.offsets.popper.top = data.storedTop;\n        return data;\n      },\n      order: 301,\n    },\n  },\n};\n\npendingPromise.resolve();\n\nexport { Bootstrap };\n"],"names":["pendingPromise","Pending","Aria","init","on","e","hash","target","attr","history","replaceState","location","window","tab","document","querySelector","click","rememberTabs","popover","container","selector","trigger","whitelist","Object","assign","DefaultWhitelist","table","thead","tbody","tr","th","td","addEventListener","key","closest","tooltip","fn","dropdown","Constructor","Default","popperConfig","modifiers","flip","enabled","storeTopPosition","data","options","storedTop","offsets","popper","top","order","restoreTopPosition","resolve"],"mappings":";;;;;;;;i+BAyFMA,eAAiB,IAAIC,iBAAQ,mDAMnCC,KAAKC,OA7DgB,0BACjB,wBAAwBC,GAAG,gBAAgB,SAAUC,OACjDC,MAAO,mBAAED,EAAEE,QAAQC,KAAK,QACxBC,QAAQC,aACVD,QAAQC,aAAa,KAAM,KAAMJ,MAEjCK,SAASL,KAAOA,cAGdA,KAAOM,OAAOD,SAASL,QACzBA,KAAM,OACFO,IAAMC,SAASC,cAAc,2BAA6BT,KAAO,MACnEO,KACFA,IAAIG,UAmDVC,uBAzCI,QAAQC,QAAQ,CAChBC,UAAW,OACXC,SAAU,0BACVC,QAAS,QACTC,UAAWC,OAAOC,OAAOC,4BAAkB,CACzCC,MAAO,GACPC,MAAO,GACPC,MAAO,GACPC,GAAI,GACJC,GAAI,GACJC,GAAI,OAIRjB,SAASkB,iBAAiB,WAAY3B,IACtB,WAAVA,EAAE4B,KAAoB5B,EAAEE,OAAO2B,QAAQ,gDACvC7B,EAAEE,QAAQW,QAAQ,+BAUtB,QAAQiB,QAAQ,CAChBhB,UAAW,OACXC,SAAU,4CAuBZgB,GAAGC,SAASC,YAAYC,QAAQC,aAAe,CAC/CC,UAAW,CACTC,KAAM,CACJC,SAAS,GAEXC,iBAAkB,CAChBD,SAAS,EAETP,GAAE,CAACS,KAAMC,WACPD,KAAKE,UAAYF,KAAKG,QAAQC,OAAOC,IAC9BL,MAETM,MAAO,KAETC,mBAAoB,CAClBT,SAAS,EAETP,GAAE,CAACS,KAAMC,WACPD,KAAKG,QAAQC,OAAOC,IAAML,KAAKE,UACxBF,MAETM,MAAO,OAKbnD,eAAeqD"}